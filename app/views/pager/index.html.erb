<%= render :partial => "users/users" %>
<script src="/assets/jquery.tmpl.min.js" type="text/javascript" charset="utf-8"></script>
<script src="/assets/jquery.pager.js" type="text/javascript" charset="utf-8"></script>


<script type="text/javascript">
	function getUsers (pageIndex) {
		$('#users').fadeOut(400, function() {
			$.ajax({
			  url: '/pager?page=' + pageIndex,
			  type: 'GET',
			  dataType: 'json',

			  success: function(data, textStatus, xhr) {
			  	var results = $.parseJSON(data.results);
				$('#users_tmpl').tmpl(results).appendTo($('#users').empty());
				$('#users').fadeIn(500);
				$( "#pager" ).pager({ pagenumber: data.pagenumber, pagecount: data.pagecount, buttonClickCallback: getUsers});
			  },
			  error: function(xhr, textStatus, errorThrown) {
			  	$('#users').html('something go wrong, try later');
			  }
			});
		});
	}
	getUsers(1);
</script>